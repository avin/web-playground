"use strict";(()=>{var z=`precision highp float;uniform float iTime;uniform vec2 iResolution;uniform vec3 backColor;uniform float count;varying float vIdx;varying float vUseColor;
#define DYNAMIC_COLOR 1
#define hue(h) clamp(abs(fract(h + vec4(3, 2, 1, 0) / 3.) * 6. - 3.) - 1., 0., 1.)
void main(){vec3 baseColor=backColor;if(vUseColor>.5){float hueFactor=vIdx/count;if(DYNAMIC_COLOR==1){hueFactor+=iTime*.1;}vec3 col=hue(hueFactor).rgb;baseColor.rgb=col;}gl_FragColor=vec4(baseColor,1.);}`;var Y=`precision highp float;attribute vec2 a_position;attribute float a_idx;attribute float a_useColor;attribute float a_offset;uniform float count;uniform float iTime;uniform vec2 iResolution;uniform float sizeFactor;varying float vIdx;varying float vUseColor;
#define MOD3 vec3(.1031, .11369, .13787)
vec3 hash33(vec3 p3){p3=fract(p3*MOD3);p3+=dot(p3,p3.yxz+19.19);return-1.0+2.0*fract(vec3((p3.x+p3.y)*p3.z,(p3.x+p3.z)*p3.y,(p3.y+p3.z)*p3.x));}float noise(vec3 p){const float K1=0.333333333;const float K2=0.166666667;vec3 i=floor(p+(p.x+p.y+p.z)*K1);vec3 d0=p-(i-(i.x+i.y+i.z)*K2);vec3 e=step(vec3(0.0),d0-d0.yzx);vec3 i1=e*(1.0-e.zxy);vec3 i2=1.0-e.zxy*(1.0-e);vec3 d1=d0-(i1-1.0*K2);vec3 d2=d0-(i2-2.0*K2);vec3 d3=d0-(1.0-3.0*K2);vec4 h=max(0.6-vec4(dot(d0,d0),dot(d1,d1),dot(d2,d2),dot(d3,d3)),0.0);vec4 n=h*h*h*h*vec4(dot(d0,hash33(i)),dot(d1,hash33(i+i1)),dot(d2,hash33(i+i2)),dot(d3,hash33(i+1.0)));return dot(vec4(31.316),n);}void main(void){vec3 positionUpdated=vec3(a_position,a_idx/(count*3.));positionUpdated.x*=2.;float idx=a_idx-count/2.;vIdx=idx;vUseColor=a_useColor;float t=iTime*.5;float xFactor=positionUpdated.x;float moveFactor=noise(vec3(xFactor*sizeFactor,idx*.15-t,1.))*.25;moveFactor*=step(.5,positionUpdated.y);positionUpdated.y+=moveFactor;positionUpdated.y-=a_offset+.5;gl_Position=vec4(positionUpdated,1.0);}`;var nt=.03,at=700,ct=20,st=.012,ft=.01,_=[23/255,32/255,38/255],dt=0,lt=200,A=document.querySelector("#canvas"),t=A.getContext("webgl")||A.getContext("experimental-webgl"),u=window.devicePixelRatio||1,h=t.getExtension("ANGLE_instanced_arrays");if(!h)throw new Error("no instances");var At=e=>{let i=e.clientWidth,d=e.clientHeight;(e.width!==i||e.height!==d)&&(e.width=i*u,e.height=d*u,t.viewport(0,0,t.canvas.width,t.canvas.height))},ut=(e=1,i=1,d=1,Z=1)=>{let r=d,l=Z,E=(r+1)*(l+1),g=r*l*6,F=new Float32Array(E*3),m=new Float32Array(E*3),C=new Float32Array(E*2),s=g>65536?new Uint32Array(g):new Uint16Array(g),y=0,w=1,I=2,$=1,X=-1,n=0,f=0,D=0,x=n,j=e/r,J=i/l;for(let a=0;a<=l;a++){let Q=a*J-i/2;for(let c=0;c<=r;c++,n++){let tt=c*j-e/2;if(F[n*3+y]=tt*$,F[n*3+w]=Q*X,F[n*3+I]=D/2,m[n*3+y]=0,m[n*3+w]=0,m[n*3+I]=D>=0?1:-1,C[n*2]=c/r,C[n*2+1]=1-a/l,a===l||c===r)continue;let et=x+c+a*(r+1),O=x+c+(a+1)*(r+1),ot=x+c+(a+1)*(r+1)+1,N=x+c+a*(r+1)+1;s[f*6]=et,s[f*6+1]=O,s[f*6+2]=N,s[f*6+3]=O,s[f*6+4]=ot,s[f*6+5]=N,f++}}return{position:{size:3,data:F},normal:{size:3,data:m},uv:{size:2,data:C},index:{data:s}}},S=ut(1,1,lt,1),R=ct,P=[],M=[],L=[],b=0;for(let e=0;e<R*3;e+=1)for(let i=0;i<3;i+=1){let d=i===1?st:ft;P[b]=e-R/2,M[b]=i===1?1:0,L[b]=i*d+(e-R/2)*nt-dt,b+=1}console.log(L);var v=t.createShader(t.VERTEX_SHADER);t.shaderSource(v,Y);t.compileShader(v);if(!t.getShaderParameter(v,t.COMPILE_STATUS))throw new Error(`could not compile shader: ${t.getShaderInfoLog(v)||""}`);var p=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(p,z);t.compileShader(p);if(!t.getShaderParameter(p,t.COMPILE_STATUS))throw new Error(`could not compile shader: ${t.getShaderInfoLog(p)||""}`);var o=t.createProgram();t.attachShader(o,v);t.attachShader(o,p);t.linkProgram(o);t.useProgram(o);var W=t.getAttribLocation(o,"a_position"),U=t.getAttribLocation(o,"a_idx"),B=t.getAttribLocation(o,"a_useColor"),T=t.getAttribLocation(o,"a_offset"),Rt=t.getUniformLocation(o,"iTime"),vt=t.getUniformLocation(o,"iResolution"),pt=t.getUniformLocation(o,"sizeFactor"),ht=t.getUniformLocation(o,"count"),Ft=t.getUniformLocation(o,"backColor"),G=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,G);t.bufferData(t.ARRAY_BUFFER,S.position.data,t.STATIC_DRAW);var H=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,H);t.bufferData(t.ARRAY_BUFFER,new Float32Array(P),t.STATIC_DRAW);var K=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,K);t.bufferData(t.ARRAY_BUFFER,new Float32Array(M),t.STATIC_DRAW);var V=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,V);t.bufferData(t.ARRAY_BUFFER,new Float32Array(L),t.STATIC_DRAW);var k=t.createBuffer();t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,k);t.bufferData(t.ELEMENT_ARRAY_BUFFER,S.index.data,t.STATIC_DRAW);t.bindBuffer(t.ARRAY_BUFFER,G);t.enableVertexAttribArray(W);t.vertexAttribPointer(W,3,t.FLOAT,!1,0,0);t.bindBuffer(t.ARRAY_BUFFER,H);t.enableVertexAttribArray(U);t.vertexAttribPointer(U,1,t.FLOAT,!1,0,0);h.vertexAttribDivisorANGLE(U,1);t.bindBuffer(t.ARRAY_BUFFER,K);t.enableVertexAttribArray(B);t.vertexAttribPointer(B,1,t.FLOAT,!1,0,0);h.vertexAttribDivisorANGLE(B,1);t.bindBuffer(t.ARRAY_BUFFER,V);t.enableVertexAttribArray(T);t.vertexAttribPointer(T,1,t.FLOAT,!1,0,0);h.vertexAttribDivisorANGLE(T,1);function q(e){At(A),t.clearColor(_[0],_[1],_[2],1),t.clear(t.COLOR_BUFFER_BIT),t.uniform1f(Rt,e/1e3),t.uniform1f(pt,A.clientWidth*u/at),t.uniform1f(ht,R),t.uniform3fv(Ft,_),t.uniform2f(vt,A.clientWidth*u,A.clientHeight*u),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,k),h.drawElementsInstancedANGLE(t.TRIANGLES,S.index.data.length,t.UNSIGNED_SHORT,0,R*3),window.requestAnimationFrame(q)}q();})();
