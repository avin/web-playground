{
  "version": 3,
  "sources": ["../../../static/root/0012-webgl-sandbox/01-triangles/_src/shaders/fragment.glsl", "../../../static/root/0012-webgl-sandbox/01-triangles/_src/shaders/vertext.glsl", "../../../static/root/0012-webgl-sandbox/_common/utils.ts", "../../../static/root/0012-webgl-sandbox/01-triangles/_src/index.ts"],
  "sourcesContent": ["export default `#version 300 es\nprecision highp float;uniform vec3 triColor;uniform float time;uniform float speed;uniform float useVColor;in vec4 v_color;out vec4 outColor;void main(){vec3 col=triColor;col.g=(sin(time*10.*speed)*.5+.5);if(useVColor==1.){outColor=v_color;}else{outColor=vec4(col,1);}}`", "export default `#version 300 es\nin vec4 a_position;uniform float time;uniform float speed;out vec4 v_color;void rotate(in float angle,inout vec2 uv){float ca=cos(angle);float sa=sin(angle);uv*=mat2(ca,-sa,sa,ca);}void main(){vec2 pos=a_position.xy;rotate(time*speed,pos);gl_Position=vec4(pos,0.,1.);v_color=gl_Position*.5+.5;}`", "export const createShader = (\n  gl: WebGL2RenderingContext,\n  type: number,\n  source: string,\n): WebGLShader => {\n  const shader = gl.createShader(type);\n  if (!shader) {\n    throw new Error('createShader failed');\n  }\n\n  gl.shaderSource(shader, source);\n  gl.compileShader(shader);\n  if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n    // gl.deleteShader(shader);\n    throw new Error(\n      `could not compile shader: ${gl.getShaderInfoLog(shader) || ''}`,\n    );\n  }\n\n  return shader;\n};\n\nexport const createProgram = (\n  gl: WebGL2RenderingContext,\n  vertexShader: WebGLShader,\n  fragmentShader: WebGLShader,\n): WebGLProgram => {\n  const program = gl.createProgram();\n  if (!program) {\n    throw new Error('createProgram failed');\n  }\n\n  gl.attachShader(program, vertexShader);\n  gl.attachShader(program, fragmentShader);\n  gl.linkProgram(program);\n  if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\n    // gl.deleteProgram(program);\n    throw new Error(\n      `program failed to link:${gl.getProgramInfoLog(program) || ''}`,\n    );\n  }\n\n  return program;\n};\n\nexport const createAndSetupTexture = (\n  gl: WebGL2RenderingContext,\n): WebGLTexture => {\n  const texture = gl.createTexture();\n  gl.bindTexture(gl.TEXTURE_2D, texture);\n\n  // Set up texture so we can render any size image and so we are\n  // working with pixels.\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n\n  if (texture === null) {\n    throw new Error('texture create fail');\n  }\n\n  return texture;\n};\n\nexport const setCanvasSizeForTexture = (\n  gl: WebGL2RenderingContext,\n  texture: WebGLTexture,\n): void => {\n  gl.bindTexture(gl.TEXTURE_2D, texture);\n  {\n    // make the texture the same size as the image\n    const mipLevel = 0; // the largest mip\n    const internalFormat = gl.RGBA; // format we want in the texture\n    const border = 0; // must be 0\n    const srcFormat = gl.RGBA; // format of data we are supplying\n    const srcType = gl.UNSIGNED_BYTE; // type of data we are supplying\n    const data = null; // no data = create a blank texture\n    gl.texImage2D(\n      gl.TEXTURE_2D,\n      mipLevel,\n      internalFormat,\n      gl.canvas.width,\n      gl.canvas.height,\n      border,\n      srcFormat,\n      srcType,\n      data,\n    );\n  }\n};\n\nexport const resizeCanvasToDisplaySize = (\n  canvas: HTMLCanvasElement,\n): boolean => {\n  // Lookup the size the browser is displaying the canvas in CSS pixels.\n  const displayWidth = canvas.clientWidth;\n  const displayHeight = canvas.clientHeight;\n\n  // Check if the canvas is not the same size.\n  const needResize =\n    canvas.width !== displayWidth || canvas.height !== displayHeight;\n\n  if (needResize) {\n    // Make the canvas the same size\n    canvas.width = displayWidth;\n    canvas.height = displayHeight;\n  }\n\n  return needResize;\n};\n", "import fragmentShaderSource from './shaders/fragment.glsl';\nimport vertexShaderSource from './shaders/vertext.glsl';\nimport {\n  createProgram,\n  createShader,\n  resizeCanvasToDisplaySize,\n} from '../../_common/utils';\n\nconst canvas: HTMLCanvasElement | null = document.querySelector('#canvas');\nif (!canvas) {\n  throw new Error('no canvas');\n}\n\nconst gl = canvas.getContext('webgl2');\nif (!gl) {\n  throw new Error('no gl context');\n}\n\nconst vertexShader = createShader(gl, gl.VERTEX_SHADER, vertexShaderSource);\nconst fragmentShader = createShader(\n  gl,\n  gl.FRAGMENT_SHADER,\n  fragmentShaderSource,\n);\n\nconst program = createProgram(gl, vertexShader, fragmentShader);\n\nconst positionAttributeLocation = gl.getAttribLocation(program, 'a_position');\nconst triColorLoc = gl.getUniformLocation(program, 'triColor');\nconst timeLoc = gl.getUniformLocation(program, 'time');\nconst speedLoc = gl.getUniformLocation(program, 'speed');\nconst useVColorLoc = gl.getUniformLocation(program, 'useVColor');\n\nconst vao1 = gl.createVertexArray();\ngl.bindVertexArray(vao1);\n\n{\n  const positions =\n    /* prettier-ignore */ new Float32Array([\n    0, 0,\n    0, 0.5,\n    0.7, 0,\n  ]);\n  gl.bindBuffer(gl.ARRAY_BUFFER, gl.createBuffer());\n  gl.bufferData(gl.ARRAY_BUFFER, positions, gl.STATIC_DRAW);\n\n  gl.enableVertexAttribArray(positionAttributeLocation);\n  gl.vertexAttribPointer(\n    positionAttributeLocation,\n    2, // size - 2 components per iteration\n    gl.FLOAT, // type - the data is 32bit floats\n    false, // normalize - don't normalize the data\n    0, // stride  - 0 = move forward size * sizeof(type) each iteration to get the next position\n    0, // offset - start at the beginning of the buffer\n  );\n}\n\n// --------------\n\nconst vao2 = gl.createVertexArray();\ngl.bindVertexArray(vao2);\n\n{\n  const positions =\n    /* prettier-ignore */ new Float32Array([\n    .5, .5,\n     1, .5,\n    .25, 0,\n  ]);\n  gl.bindBuffer(gl.ARRAY_BUFFER, gl.createBuffer());\n  gl.bufferData(gl.ARRAY_BUFFER, positions, gl.STATIC_DRAW);\n\n  gl.enableVertexAttribArray(positionAttributeLocation);\n  gl.vertexAttribPointer(\n    positionAttributeLocation,\n    2, // size - 2 components per iteration\n    gl.FLOAT, // type - the data is 32bit floats\n    false, // normalize - don't normalize the data\n    0, // stride  - 0 = move forward size * sizeof(type) each iteration to get the next position\n    0, // offset - start at the beginning of the buffer\n  );\n}\n\nconst startTime = +new Date();\n(function frame() {\n  const isNeedResize = resizeCanvasToDisplaySize(\n    gl.canvas as HTMLCanvasElement,\n  );\n  if (isNeedResize) {\n    gl.viewport(0, 0, gl.canvas.width, gl.canvas.height);\n  }\n\n  // Clear the canvas\n  gl.clearColor(0, 0, 0, 0);\n  gl.clear(gl.COLOR_BUFFER_BIT);\n\n  // Tell it to use our program (pair of shaders)\n  gl.useProgram(program);\n\n  const time = (+new Date() - startTime) / 1000;\n  gl.uniform1f(timeLoc, time);\n\n  // Bind the attribute/buffer set we want.\n  gl.bindVertexArray(vao1);\n\n  gl.uniform1f(speedLoc, 1);\n  gl.uniform1f(useVColorLoc, 0);\n\n  gl.uniform3fv(triColorLoc, [1, 0.7, 0.7]);\n\n  gl.drawArrays(\n    gl.TRIANGLES, // primitiveType\n    0, // offset\n    3, // count\n  );\n\n  // Bind the attribute/buffer set we want.\n  gl.bindVertexArray(vao2);\n\n  gl.uniform1f(speedLoc, 2);\n  gl.uniform1f(useVColorLoc, 1);\n\n  gl.uniform3fv(triColorLoc, [0.5, 1.0, 0.7]);\n\n  gl.drawArrays(\n    gl.TRIANGLES, // primitiveType\n    0, // offset\n    3, // count\n  );\n\n  requestAnimationFrame(frame);\n})();\n"],
  "mappings": "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",
  "names": ["fragment_default", "vertext_default", "createShader", "gl", "type", "source", "shader", "createProgram", "vertexShader", "fragmentShader", "program", "resizeCanvasToDisplaySize", "canvas", "displayWidth", "displayHeight", "needResize", "canvas", "gl", "vertexShader", "createShader", "vertext_default", "fragmentShader", "fragment_default", "program", "createProgram", "positionAttributeLocation", "triColorLoc", "timeLoc", "speedLoc", "useVColorLoc", "vao1", "positions", "vao2", "startTime", "frame", "resizeCanvasToDisplaySize", "time"]
}
