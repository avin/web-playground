"use strict";(()=>{var u=(t,a,e)=>{let o=t.createShader(a);if(!o)throw new Error("createShader failed");if(t.shaderSource(o,e),t.compileShader(o),!t.getShaderParameter(o,t.COMPILE_STATUS))throw new Error(`could not compile shader: ${t.getShaderInfoLog(o)||""}`);return o},v=(t,a,e)=>{let o=t.createProgram();if(!o)throw new Error("createProgram failed");if(t.attachShader(o,a),t.attachShader(o,e),t.linkProgram(o),!t.getProgramParameter(o,t.LINK_STATUS))throw new Error(`program failed to link:${t.getProgramInfoLog(o)||""}`);return o};var F=t=>{let a=t.clientWidth,e=t.clientHeight,o=t.width!==a||t.height!==e;return o&&(t.width=a,t.height=e),o};var p=`#version 300 es
precision highp float;in vec3 v_color;out vec4 outColor;void main(){outColor=vec4(v_color,.5);}`;var L=`#version 300 es
in vec4 a_position;in vec2 a_offset;in float a_rotation;in vec3 a_color;in float a_speed;uniform float u_time;uniform vec2 u_resolution;out vec3 v_color;void rotate(in float angle,inout vec2 uv){float ca=cos(angle);float sa=sin(angle);uv*=mat2(ca,-sa,sa,ca);}void main(){vec4 pos=a_position;rotate(u_time*a_speed+float(gl_InstanceID),pos.xy);pos.x*=u_resolution.y/u_resolution.x;pos=pos+vec4(a_offset,0.,0.);gl_Position=pos;v_color=a_color;}`;(()=>{let t=new window.Stats;t.showPanel(0),document.body.appendChild(t.dom);let a=document.querySelector("#canvas");if(!a)throw new Error("no canvas");let e=a.getContext("webgl2");if(!e)throw new Error("no gl context");e.enable(e.BLEND),e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);let o=u(e,e.VERTEX_SHADER,L),x=u(e,e.FRAGMENT_SHADER,p),n=v(e,o,x),d=e.getAttribLocation(n,"a_position"),s=e.getAttribLocation(n,"a_offset"),c=e.getAttribLocation(n,"a_color"),f=e.getAttribLocation(n,"a_speed"),w=e.getUniformLocation(n,"u_time"),D=e.getUniformLocation(n,"u_resolution"),i=5e3,E=new Float32Array(i*2),U=new Float32Array(i*1),_=new Float32Array(i*3),R=new Float32Array(i*1),T=[],h=[],m=[],l=[];for(let r=0;r<i;r+=1)m.push(new Float32Array(E.buffer,r*2*4,2)),h.push(new Float32Array(U.buffer,r*1*4,1)),T.push(new Float32Array(_.buffer,r*3*4,3)),l.push(new Float32Array(R.buffer,r*1*4,1));m.forEach(r=>{r[0]=Math.random()*2-1,r[1]=Math.random()*2-1}),h.forEach(r=>{r[0]=Math.random()}),T.forEach(r=>{r[0]=Math.random(),r[1]=Math.random(),r[2]=Math.random()}),l.forEach(r=>{r[0]=Math.random()*2+.5});let b=e.createVertexArray();e.bindVertexArray(b);{let A=new Float32Array([-.025,-.025,.025,-.025,.025,.025,-.025,.025]);e.bindBuffer(e.ARRAY_BUFFER,e.createBuffer()),e.bufferData(e.ARRAY_BUFFER,A,e.STATIC_DRAW),e.enableVertexAttribArray(d),e.vertexAttribPointer(d,2,e.FLOAT,!1,0,0);let S=new Uint16Array([0,1,3,3,1,2]);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,e.createBuffer()),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array(S),e.STATIC_DRAW);let B=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,B),e.bufferData(e.ARRAY_BUFFER,E,e.STATIC_DRAW),e.enableVertexAttribArray(s),e.vertexAttribPointer(s,2,e.FLOAT,!1,0,0),e.vertexAttribDivisor(s,1);let P=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,P),e.bufferData(e.ARRAY_BUFFER,_,e.STATIC_DRAW),e.enableVertexAttribArray(c),e.vertexAttribPointer(c,3,e.FLOAT,!1,0,0),e.vertexAttribDivisor(c,1);let C=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,C),e.bufferData(e.ARRAY_BUFFER,R,e.STATIC_DRAW),e.enableVertexAttribArray(f),e.vertexAttribPointer(f,1,e.FLOAT,!1,0,0),e.vertexAttribDivisor(f,1),e.bindVertexArray(null),e.bindBuffer(e.ARRAY_BUFFER,null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)}let y=+new Date;(function r(){t.begin();let A=(+new Date-y)/1e3;F(e.canvas)&&e.viewport(0,0,e.canvas.width,e.canvas.height),e.clearColor(1,1,1,1),e.clear(e.COLOR_BUFFER_BIT),e.useProgram(n),e.uniform1f(w,A),e.uniform2fv(D,[e.canvas.width,e.canvas.height]),e.bindVertexArray(b),e.drawElementsInstanced(e.TRIANGLES,6,e.UNSIGNED_SHORT,0,i),e.bindVertexArray(null),t.end(),requestAnimationFrame(r)})()})();})();
