"use strict";(()=>{var h=(e,n)=>()=>(n||e((n={exports:{}}).exports,n),n.exports);var c=(e,n,t)=>new Promise((o,u)=>{var l=r=>{try{w(t.next(r))}catch(y){u(y)}},p=r=>{try{w(t.throw(r))}catch(y){u(y)}},w=r=>r.done?o(r.value):Promise.resolve(r.value).then(l,p);w((t=t.apply(e,n)).next())});var v=h(a=>{var d=class extends Error{constructor(n){super(n),this.name="CancelError"}};function i(e,n){let t=new XMLHttpRequest,o=new Promise((u,l)=>{t.open(e,n),t.onload=function(){this.status>=200&&this.status<300?u(JSON.parse(t.response)):l(new Error("Response status error"))},t.onerror=function(){l(new Error("Network error"))},t.addEventListener("abort",()=>{l(new d("Canceled"))}),t.send()});return o.cancel=()=>{t.abort()},o}var f=document.querySelector("#input"),L=document.querySelector("#result"),q=e=>{L.innerHTML=e};f.addEventListener("input",e=>{q(e.target.value)});var E;document.querySelector("#start").addEventListener("click",()=>c(a,null,function*(){E=i("GET","/api/test1.do");let e=yield E;q(e.result)}));document.querySelector("#stop").addEventListener("click",()=>c(a,null,function*(){E.cancel()}));var m=e=>{let n={req:void 0},t=e(n);return t.cancel=()=>{try{n.req.cancel()}catch(o){}},t},s,S=()=>c(a,null,function*(){try{s&&s.cancel(),s=m(e=>(()=>c(a,null,function*(){e.req=i("GET","/api/test1.do");let n=yield e.req;e.req=i("GET","/api/test2.do");let t=yield e.req;return`cr=${n.result}${t.result}`}))()),yield s,s=m(e=>(()=>c(a,null,function*(){e.req=i("GET","/api/test1.do");let n=yield e.req;e.req=i("GET","/api/test2.do");let t=yield e.req;return`cr=${n.result}${t.result}`}))()),yield s}catch(e){if(e instanceof d)return console.log("canceled"),123;throw e}});document.querySelector("#start-complex").addEventListener("click",()=>c(a,null,function*(){try{let e=yield S()}catch(e){console.warn(e)}}));document.querySelector("#stop-complex").addEventListener("click",()=>c(a,null,function*(){s.cancel()}))});v();})();
