var r=class{constructor(){this.limit=56;this.page=0,this.loading=!1,this.hasMore=!0,this.items=[]}async loadMore(){if(!(this.loading||!this.hasMore)){this.page++,this.loading=!0;try{let e=await fetch(`/api/items?page=${this.page}&limit=${this.limit}`);if(!e.ok)throw new Error(`Error with status ${e.status}`);let s=await e.json();this.items.push(...s),s.length<this.limit&&(this.hasMore=!1)}catch(e){throw this.page--,e}finally{this.loading=!1}}}reset(){this.page=0,this.loading=!1,this.hasMore=!0,this.items=[]}},i=document.querySelector("#sentinel"),a=document.querySelector("#rows"),l=document.querySelector("#data"),o=new r,c;(c=document.querySelector("#reset"))==null||c.addEventListener("click",()=>{o.reset(),a.innerHTML=""});function d(){let t=i.getBoundingClientRect(),e=l.getBoundingClientRect();return t.top<e.bottom}(async()=>{let t=new IntersectionObserver(e=>{e.forEach(s=>{s.isIntersecting&&(console.log("\u0414\u043E\u0441\u0442\u0438\u0433\u043D\u0443\u0442 \u043A\u043E\u043D\u0435\u0446 \u0441\u043F\u0438\u0441\u043A\u0430!"),(async()=>(await o.loadMore(),a.innerHTML="",o.items.forEach(h=>{let n=document.createElement("div");n.className="row",n.innerText=`ID: ${h.id}`,a.append(n)}),d()&&o.hasMore&&!o.loading&&(console.log("\u{1F501} Sentinel \u0432\u0438\u0434\u0435\u043D, \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043C \u0435\u0449\u0451..."),t.unobserve(i),t.observe(i))))())})},{root:l,rootMargin:"0px",threshold:.1});t.observe(i)})();
//# sourceMappingURL=script.js.map
